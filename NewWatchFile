#set up imports
import pandas as pd
import numpy as np
import glob
import os
import fnmatch


#path to files
path=r'C:\Users\Isabelle\Python\Individual_Watch_Exports'


list_=[]
#name columns
my_columns=["Line","Date","Time","Off-Wrist Status","Activity","Marker","White Light","Red Light","Green Light","Blue Light","Sleep/Wake","Interval Status"]


for filename in os.listdir(path):
	subject_id=filename.split("_")[1]
	if ('Subject_'+ subject_id) in filename:
		#read csv
		df=pd.read_csv(path,filename, names = my_columns, encoding='utf-8')
		#covert to dataframe. slice the dataframe 
		df2=pd.DataFrame(df[(df["Interval Status"]=="ACTIVE")|(df["Interval Status"]=="REST")|(df["Interval Status"]=="REST-S")|(df["Interval Status"]=="EXCLUDED")])
		list_.append(df2)
		break
	frame = pd.concat(list_)
	print (frame)
	frame.to_csv("Merged_Subject_"+ subject_id +".csv")
